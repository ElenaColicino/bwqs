<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Nicolo Foppa Pedretti, Elena Colicino" />


<title>Bayesian Weighted Quantile Sum Regression</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Bayesian Weighted Quantile Sum
Regression</h1>
<h4 class="author">Nicolo Foppa Pedretti, Elena Colicino</h4>
<h4 class="date">26 January, 2023</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The Bayesian Weighted Quantile Sum (BWQS) regression is a statistical
model for accommodating mixtures. The algorithm provides a weighted
index of the mixture components and its overall association with an
outcome, which can be continuous or binary. The overall association of
the mixture index (BWQS index) is estimated adjusting for a set of
covariates. The prior distributions of all parameters are considered
uninformative. Parameters mapped to the overall mixture, and the
covariates follow uaninformative Normal distributions, while we assumed
a Dirichlet prior density for the weights. The BWQS package has several
dependencies, which are uploaded automatically with the BWQS
package.</p>
<p>The algorithms are applied to a simulated dataset and all the steps
are listed in order to make reproducible analyses. In this first part of
the code the environment is set up with all the useful libraries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BWQS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: StanHeaders</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rstan version 2.26.13 (Stan version 2.26.1)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; For execution on a local, multicore CPU with excess RAM we recommend calling</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; options(mc.cores = parallel::detectCores()).</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; To avoid recompilation of unchanged Stan programs, we recommend calling</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rstan_options(auto_write = TRUE)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; For within-chain threading using `reduce_sum()` or `map_rect()` Stan functions,</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; change `threads_per_chain` option:</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rstan_options(threads_per_chain = 1)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Do not specify &#39;-march=native&#39; in &#39;LOCAL_CPPFLAGS&#39; or a Makevars file</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(clusterGeneration)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code></pre></div>
</div>
<div id="bayesian-quantile-weighted-sums" class="section level2">
<h2>Bayesian Quantile Weighted Sums</h2>
<p>The function <code>bwqs</code> fits the Bayesian Quantile Weighted
Sums model. The object <code>family</code> allows the model to be used
for both continuous or binary outcomes. The model is the following <span class="math display">\[y_i = \beta_0 + \beta_1 \sum_{i=0}^5w_jq_{ij} +
\sum_{k=0}^2 \delta_kc_{ik}\]</span> where <span class="math inline">\(\beta_0\)</span> is the intercept, <span class="math inline">\(\beta_1\)</span> is the overall association of the
mixture with the outcome, <span class="math inline">\(\sum_{i=0}^5w_jq_{ij}\)</span> is the mixture
composition made by the product between weights and quartiles
(<code>q = 4</code> in <code>bwqs</code> function) of the metals
concentrations.</p>
<p>Synthetic dataset made of 1000 observations with a mixture composed
by 5 metals (Al, As, Cd, Pb, V). The coefficients are <span class="math inline">\(\beta_0 = -2\)</span>, <span class="math inline">\(\beta_1 = 0.8\)</span>, the set of weights <span class="math inline">\(w = [0.50,0.20,0.20,0.05,0.05]\)</span> and the
overall <span class="math inline">\(\sigma = 1\)</span>. Two additional
covariates are included in the model with two coefficients <span class="math inline">\(\delta_1 = 0.5\)</span> and <span class="math inline">\(\delta_2 = 1.1\)</span>. Here the dataset:</p>
<pre><code>#&gt;        y     Al     As     Cd     Pb     V   cov1   cov2
#&gt; 1 -0.362  0.136 -0.679 -1.507  2.094 3.267  2.509  0.745
#&gt; 2 -4.769  0.156 -0.628 -0.601  0.961 2.002  1.275  0.615
#&gt; 3 -0.725  0.008  0.240 -0.209  3.023 3.684  1.552  0.871
#&gt; 4 -2.265 -0.634 -0.818 -1.014  0.252 2.289  0.624 -0.194
#&gt; 5 -3.288  0.057 -0.758 -0.797  1.778 2.730 -0.242  0.412
#&gt; 6 -1.250 -1.137 -1.465 -0.315 -5.971 1.100  1.439  1.237</code></pre>
<p>Now that we have the dataset we can fit the <strong>BWQS</strong>
model with the following code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we run the model ans save results in &quot;fit_bwqs&quot; variable</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fit_bwqs <span class="ot">=</span> <span class="fu">bwqs</span>(y <span class="sc">~</span> cov1 <span class="sc">+</span> cov2, <span class="at">mix_name =</span> <span class="fu">c</span>(<span class="st">&#39;Al&#39;</span>,<span class="st">&#39;As&#39;</span>,<span class="st">&#39;Cd&#39;</span>,<span class="st">&#39;Pb&#39;</span>,<span class="st">&#39;V&#39;</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> Data, <span class="at">q =</span> <span class="dv">4</span>, <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>)</span></code></pre></div>
<p>The first function object is the underlying model, i.e. formula
<code>y ~ cov1 + cov2</code>; here we have the outcome <code>y</code>
and two covariates. Additional covariates can be included in the formula
separated by <code>+</code>. If no covariates are included in the model,
the formula has to be specified as <code>y ~ NULL</code>. The
<code>mix_name</code> object contains a <strong>vector of
strings</strong> with the name of the mixture components. Data is the
name of the dataset, containing the outcome, the mixture components, and
the covariates, note that the dataset should ve in
<code>data.frame</code> format. The <code>q</code> object indicates how
the mixture components are categorized (as quantiles), by default is set
on 4 (quartiles), but also allows deciles (<code>q = 10</code>),
centiles (<code>q = 100</code>) or continuous values
(<code>q = NULL</code>). Other parameters can be modified; please check
the BWQS package documentation for details.</p>
<p>Results are saved in the <code>fit_bwqs</code> object, which can be
used to plot the results. In the results table: the first two columns
are the mean and the standard deviation of the mean, the two following
columns contain the values of the credible interval at 95%. The credible
interval level can be chosen using the <code>c_int</code> parameter. The
last two columns report values to evaluate the fitness of parameters and
the convergence of the algorithm.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fit_bwqs<span class="sc">$</span>summary_fit <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Cambria&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta0
</td>
<td style="text-align:right;">
-1.96052
</td>
<td style="text-align:right;">
0.00227
</td>
<td style="text-align:right;">
0.08637
</td>
<td style="text-align:right;">
-2.13679
</td>
<td style="text-align:right;">
-1.80047
</td>
<td style="text-align:right;">
1453.666
</td>
<td style="text-align:right;">
0.99960
</td>
</tr>
<tr>
<td style="text-align:left;">
beta1
</td>
<td style="text-align:right;">
-0.80540
</td>
<td style="text-align:right;">
0.00100
</td>
<td style="text-align:right;">
0.03866
</td>
<td style="text-align:right;">
-0.87782
</td>
<td style="text-align:right;">
-0.72781
</td>
<td style="text-align:right;">
1500.163
</td>
<td style="text-align:right;">
0.99969
</td>
</tr>
<tr>
<td style="text-align:left;">
C_cov1
</td>
<td style="text-align:right;">
0.48776
</td>
<td style="text-align:right;">
0.00080
</td>
<td style="text-align:right;">
0.03133
</td>
<td style="text-align:right;">
0.42677
</td>
<td style="text-align:right;">
0.54851
</td>
<td style="text-align:right;">
1540.710
</td>
<td style="text-align:right;">
0.99941
</td>
</tr>
<tr>
<td style="text-align:left;">
C_cov2
</td>
<td style="text-align:right;">
1.16089
</td>
<td style="text-align:right;">
0.00159
</td>
<td style="text-align:right;">
0.06456
</td>
<td style="text-align:right;">
1.03334
</td>
<td style="text-align:right;">
1.29555
</td>
<td style="text-align:right;">
1657.285
</td>
<td style="text-align:right;">
0.99943
</td>
</tr>
<tr>
<td style="text-align:left;">
W_Al
</td>
<td style="text-align:right;">
0.52174
</td>
<td style="text-align:right;">
0.00124
</td>
<td style="text-align:right;">
0.04667
</td>
<td style="text-align:right;">
0.43116
</td>
<td style="text-align:right;">
0.61460
</td>
<td style="text-align:right;">
1417.163
</td>
<td style="text-align:right;">
0.99982
</td>
</tr>
<tr>
<td style="text-align:left;">
W_As
</td>
<td style="text-align:right;">
0.16061
</td>
<td style="text-align:right;">
0.00123
</td>
<td style="text-align:right;">
0.04539
</td>
<td style="text-align:right;">
0.07256
</td>
<td style="text-align:right;">
0.25274
</td>
<td style="text-align:right;">
1360.205
</td>
<td style="text-align:right;">
0.99969
</td>
</tr>
<tr>
<td style="text-align:left;">
W_Cd
</td>
<td style="text-align:right;">
0.17522
</td>
<td style="text-align:right;">
0.00097
</td>
<td style="text-align:right;">
0.03814
</td>
<td style="text-align:right;">
0.10251
</td>
<td style="text-align:right;">
0.25002
</td>
<td style="text-align:right;">
1547.512
</td>
<td style="text-align:right;">
0.99943
</td>
</tr>
<tr>
<td style="text-align:left;">
W_Pb
</td>
<td style="text-align:right;">
0.07839
</td>
<td style="text-align:right;">
0.00092
</td>
<td style="text-align:right;">
0.03771
</td>
<td style="text-align:right;">
0.01000
</td>
<td style="text-align:right;">
0.15526
</td>
<td style="text-align:right;">
1678.854
</td>
<td style="text-align:right;">
0.99940
</td>
</tr>
<tr>
<td style="text-align:left;">
W_V
</td>
<td style="text-align:right;">
0.06405
</td>
<td style="text-align:right;">
0.00090
</td>
<td style="text-align:right;">
0.03566
</td>
<td style="text-align:right;">
0.00552
</td>
<td style="text-align:right;">
0.13908
</td>
<td style="text-align:right;">
1559.920
</td>
<td style="text-align:right;">
1.00106
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
0.98578
</td>
<td style="text-align:right;">
0.00053
</td>
<td style="text-align:right;">
0.02203
</td>
<td style="text-align:right;">
0.94380
</td>
<td style="text-align:right;">
1.02815
</td>
<td style="text-align:right;">
1742.316
</td>
<td style="text-align:right;">
1.00130
</td>
</tr>
</tbody>
</table>
<p>The following plots summarize the results: estimates and 95% credible
intervals. The first object of the function contains the results of the
model. <code>parms</code> is a vector with the name of the variables to
be plotted: <code>beta0</code> and <code>beta1</code> for the main
parameters of the model, <code>W</code> for the weights and
<code>delta</code> for the covariates. The <code>size</code> identifies
the magnitude of the means dots.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwqs_plot</span>(fit_bwqs, <span class="at">parms =</span> <span class="st">&quot;W&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="\mssm3/mssm3$/foppan01/Project_GitHub/bwqs/vignettes/bwqs_vignette_files/figure-html/plots-1.png" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwqs_plot</span>(fit_bwqs, <span class="at">parms =</span> <span class="fu">c</span>(<span class="st">&quot;beta0&quot;</span>,<span class="st">&quot;beta1&quot;</span>,<span class="st">&#39;delta&#39;</span>,<span class="st">&quot;sigma&quot;</span>), <span class="at">size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="\mssm3/mssm3$/foppan01/Project_GitHub/bwqs/vignettes/bwqs_vignette_files/figure-html/plots1-1.png" /><!-- --></p>
<p>The <code>bwqs_waic</code> function evaluates the goodness of fit for
the BWQS model. Several measures are included in the function. For
further details check <a href="http://www.stat.columbia.edu/~gelman/research/unpublished/loo_stan.pdf">here</a>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwqs_waic</span>(fit_bwqs<span class="sc">$</span>fit)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $waic</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     waic </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2817.888 </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $elpd_waic</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; elpd_waic </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1408.944 </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p_waic</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   p_waic </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8.776697 </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $elpd_loo</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  elpd_loo </span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1408.939 </span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $p_loo</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    p_loo </span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8.771992</span></span></code></pre></div>
<p>The <code>bwqs</code> function allows the user to fit model even with
different type of outcomes like <strong>binary</strong> or
<strong>poisson</strong>. In order to fit model with different outcomes
we should specify the <code>family</code> parameter in the
<code>bwqs</code> function, this parameter can be
<code>&quot;binomial&quot;</code> or <code>&quot;poisson&quot;</code> based on the outcome
that we want to use to build our model. Note that <em>binomial</em> only
allows <span class="math inline">\(\{0,1\}\)</span> values while
<em>poisson</em> allows integer number; in both cases the
misspecification of the values will lead to errors.</p>
<p>Another important feature of <code>bwqs</code> function is the
possibility to set the direction of the prior of the <span class="math inline">\(\beta_1\)</span> coefficient (the coefficient that
explain the effect of the mixture). Developing model can happen that we
have prior strong information on the constraint that the <span class="math inline">\(\beta_1\)</span> can have, in this case we only
have to specify the parameter <code>prior</code>. The default value is
<code>&quot;None&quot;</code> but it allows also <code>&quot;positive&quot;</code> and
<code>&quot;negative&quot;</code> based on the assumptions that we have on the
overall effect of the mixture.</p>
</div>
<div id="hierarchical-bayesian-quantile-weighted-sums" class="section level2">
<h2>Hierarchical Bayesian Quantile Weighted Sums</h2>
<p>Here an example for the regression model:</p>
<p><span class="math display">\[\begin{gather*}
Y_{i} \sim \mathcal{N}( \alpha_{j[i]} + \beta_{j[i]}BWQS_{i} + \gamma
Z_{i}, \sigma_c) \quad where  \quad BWQS_{i} =  \sum_{k=1}^K x_{ik}w_k
\\
\alpha \sim \mathcal{N}( \mu_{\alpha},\sigma_{\alpha}), \quad \beta \sim
\mathcal{N}( \mu_{\beta},\sigma_{\beta}) \quad where:
\\  \begin{pmatrix} \mu_{\alpha} \\ \mu_{\beta} \end{pmatrix}  \sim
\mathcal{N}_2\left( \begin{pmatrix} 0 \\ 0 \end{pmatrix},
\begin{bmatrix} 100 &amp;&amp; 0 \\ 0 &amp;&amp; 100
\end{bmatrix}  \right) \quad and  \quad  \sigma_{\alpha},\sigma_{\beta}
\sim \mathcal{IG}(0.01,0.01) \\
\sigma_c \sim \mathcal{IG}(0.01,0.01), \quad w \sim
\mathcal{Dir}_k((1,\ldots,1)) \quad and  \quad \gamma \sim
\mathcal{N}_{z} \left( \begin{pmatrix} 0 \\ \vdots \\ 0 \end{pmatrix}
,\begin{bmatrix} 100 &amp;&amp; \\ &amp; \ddots &amp; \\ &amp;&amp; 100
\end{bmatrix} \right) \
\end{gather*}\]</span></p>
<p>Notation:</p>
<ul>
<li><span class="math inline">\(i = 1, \ldots,N\)</span> is the number
of total observations</li>
<li><span class="math inline">\(j = 1, \ldots,J\)</span> is the number
of total cohorts</li>
<li><span class="math inline">\(j[i]\)</span> defines the cohort effect
for each observation (random terms)</li>
<li><span class="math inline">\(K\)</span> number of chemicals involved
in the mixture</li>
<li><span class="math inline">\(Z\)</span> number of covariates</li>
<li><span class="math inline">\(\mathcal{IG}\)</span> is a <a href="https://en.wikipedia.org/wiki/Inverse-gamma_distribution">Inverse
Gamma Distribution</a></li>
<li><span class="math inline">\(\mathcal{Dir}_k\)</span> is a <a href="https://en.wikipedia.org/wiki/Dirichlet_distribution">Dirichlet
Distribution</a> parametrized by a k-dimensional vector of 1<br />
</li>
<li><span class="math inline">\(\mathcal{N}_z\)</span> is a
z-dimensional <a href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution">Multivariate
Normal Distibution</a></li>
</ul>
<p>The HBWQS frameworks is pretty similar to the BWQS. The main
different is the flexibility on multiple cohorts. In order to specify
the cohort we need to use and additional parameter <code>cohort</code>
which is a vector of integer that needs to point every observation to
the specific cohort.</p>
<p>We generate a synthetic dataset to test the <strong>HBWQS</strong>
model: we want <strong>5</strong> different cohorts with
<strong>250</strong>,<strong>200</strong>,<strong>150</strong>,<strong>100</strong>,<strong>100</strong>
people for each cohort. We choose <strong>4</strong> chemical for the
mixture and we are using quartiles. Note that <strong>STAN</strong>
doesn’t allow factors so we have to re-map the categorical variables
into dummy variables (excluding the reference value). The index of
cohort should be an integer starting from 1 and we’ll specify the column
name in code. Here the synthetic dataset:</p>
<pre><code>#&gt;         y  m_age sex education   Ch_1  Ch_2   Ch_3  Ch_4 cohort
#&gt; 1 -14.057 39.109   0    17.457 -0.952 0.211 -0.508 0.123      1
#&gt; 2  -8.009 20.639   1    11.428 -0.890 0.189 -0.570 0.075      1
#&gt; 3  -9.864 26.356   1    14.279 -1.092 0.288 -0.781 0.102      1
#&gt; 4  -6.700 20.202   1    16.852 -0.966 0.216 -0.745 0.105      1
#&gt; 5 -10.334 27.059   0    16.722 -0.899 0.131 -0.637 0.059      1
#&gt; 6 -16.149 35.425   1    13.058 -0.798 0.305 -0.258 0.001      1</code></pre>
<p>Now that we have the dataset we can fit the <strong>HBWQS</strong>
model with the following code:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we run the model ans save results in &quot;fit_bwqs&quot; variable</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fit_hbwqs <span class="ot">=</span> <span class="fu">bwqs_r</span>(y <span class="sc">~</span> m_age <span class="sc">+</span> sex <span class="sc">+</span> education, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mix_name =</span> <span class="fu">c</span>(<span class="st">&quot;Ch_1&quot;</span>,<span class="st">&quot;Ch_2&quot;</span>,<span class="st">&quot;Ch_3&quot;</span>,<span class="st">&quot;Ch_4&quot;</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cluster_name =</span> <span class="st">&quot;cohort&quot;</span>, <span class="at">Dalp =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">thin =</span> <span class="dv">3</span>, <span class="at">data =</span> dt, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">q =</span> <span class="dv">4</span>, <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fit_hbwqs<span class="sc">$</span>summary_fit <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">&quot;Cambria&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
W_Ch_1
</td>
<td style="text-align:right;">
0.09615
</td>
<td style="text-align:right;">
0.00064
</td>
<td style="text-align:right;">
0.02485
</td>
<td style="text-align:right;">
0.04738
</td>
<td style="text-align:right;">
0.14562
</td>
<td style="text-align:right;">
1485.6266
</td>
<td style="text-align:right;">
0.99940
</td>
</tr>
<tr>
<td style="text-align:left;">
W_Ch_2
</td>
<td style="text-align:right;">
0.39419
</td>
<td style="text-align:right;">
0.00045
</td>
<td style="text-align:right;">
0.01850
</td>
<td style="text-align:right;">
0.35960
</td>
<td style="text-align:right;">
0.43199
</td>
<td style="text-align:right;">
1718.7642
</td>
<td style="text-align:right;">
1.00093
</td>
</tr>
<tr>
<td style="text-align:left;">
W_Ch_3
</td>
<td style="text-align:right;">
0.30079
</td>
<td style="text-align:right;">
0.00060
</td>
<td style="text-align:right;">
0.02382
</td>
<td style="text-align:right;">
0.25687
</td>
<td style="text-align:right;">
0.34894
</td>
<td style="text-align:right;">
1586.7660
</td>
<td style="text-align:right;">
0.99940
</td>
</tr>
<tr>
<td style="text-align:left;">
W_Ch_4
</td>
<td style="text-align:right;">
0.20886
</td>
<td style="text-align:right;">
0.00045
</td>
<td style="text-align:right;">
0.01785
</td>
<td style="text-align:right;">
0.17317
</td>
<td style="text-align:right;">
0.24262
</td>
<td style="text-align:right;">
1557.3449
</td>
<td style="text-align:right;">
1.00113
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
1.03388
</td>
<td style="text-align:right;">
0.00071
</td>
<td style="text-align:right;">
0.02659
</td>
<td style="text-align:right;">
0.98494
</td>
<td style="text-align:right;">
1.08478
</td>
<td style="text-align:right;">
1399.6442
</td>
<td style="text-align:right;">
0.99940
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma_b0
</td>
<td style="text-align:right;">
0.95115
</td>
<td style="text-align:right;">
0.01468
</td>
<td style="text-align:right;">
0.55330
</td>
<td style="text-align:right;">
0.35763
</td>
<td style="text-align:right;">
2.26906
</td>
<td style="text-align:right;">
1421.0197
</td>
<td style="text-align:right;">
0.99941
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma_b1
</td>
<td style="text-align:right;">
0.90077
</td>
<td style="text-align:right;">
0.01584
</td>
<td style="text-align:right;">
0.50395
</td>
<td style="text-align:right;">
0.41383
</td>
<td style="text-align:right;">
2.08220
</td>
<td style="text-align:right;">
1012.5934
</td>
<td style="text-align:right;">
0.99948
</td>
</tr>
<tr>
<td style="text-align:left;">
beta0_1
</td>
<td style="text-align:right;">
0.49523
</td>
<td style="text-align:right;">
0.01232
</td>
<td style="text-align:right;">
0.39113
</td>
<td style="text-align:right;">
-0.23860
</td>
<td style="text-align:right;">
1.26582
</td>
<td style="text-align:right;">
1007.8963
</td>
<td style="text-align:right;">
1.00165
</td>
</tr>
<tr>
<td style="text-align:left;">
beta0_2
</td>
<td style="text-align:right;">
-0.57370
</td>
<td style="text-align:right;">
0.01395
</td>
<td style="text-align:right;">
0.44542
</td>
<td style="text-align:right;">
-1.44082
</td>
<td style="text-align:right;">
0.27842
</td>
<td style="text-align:right;">
1018.9336
</td>
<td style="text-align:right;">
0.99985
</td>
</tr>
<tr>
<td style="text-align:left;">
beta0_3
</td>
<td style="text-align:right;">
0.10798
</td>
<td style="text-align:right;">
0.01376
</td>
<td style="text-align:right;">
0.45689
</td>
<td style="text-align:right;">
-0.77235
</td>
<td style="text-align:right;">
0.99281
</td>
<td style="text-align:right;">
1102.9471
</td>
<td style="text-align:right;">
0.99962
</td>
</tr>
<tr>
<td style="text-align:left;">
beta0_4
</td>
<td style="text-align:right;">
-0.78296
</td>
<td style="text-align:right;">
0.01623
</td>
<td style="text-align:right;">
0.51913
</td>
<td style="text-align:right;">
-1.79053
</td>
<td style="text-align:right;">
0.27632
</td>
<td style="text-align:right;">
1023.3545
</td>
<td style="text-align:right;">
1.00051
</td>
</tr>
<tr>
<td style="text-align:left;">
beta0_5
</td>
<td style="text-align:right;">
0.91330
</td>
<td style="text-align:right;">
0.01404
</td>
<td style="text-align:right;">
0.43160
</td>
<td style="text-align:right;">
0.09853
</td>
<td style="text-align:right;">
1.75549
</td>
<td style="text-align:right;">
944.6939
</td>
<td style="text-align:right;">
1.00066
</td>
</tr>
<tr>
<td style="text-align:left;">
beta1_1
</td>
<td style="text-align:right;">
-1.65577
</td>
<td style="text-align:right;">
0.00300
</td>
<td style="text-align:right;">
0.11766
</td>
<td style="text-align:right;">
-1.90190
</td>
<td style="text-align:right;">
-1.44066
</td>
<td style="text-align:right;">
1543.1221
</td>
<td style="text-align:right;">
1.00272
</td>
</tr>
<tr>
<td style="text-align:left;">
beta1_2
</td>
<td style="text-align:right;">
-0.88585
</td>
<td style="text-align:right;">
0.00381
</td>
<td style="text-align:right;">
0.15660
</td>
<td style="text-align:right;">
-1.19705
</td>
<td style="text-align:right;">
-0.58069
</td>
<td style="text-align:right;">
1688.0372
</td>
<td style="text-align:right;">
0.99960
</td>
</tr>
<tr>
<td style="text-align:left;">
beta1_3
</td>
<td style="text-align:right;">
-0.13479
</td>
<td style="text-align:right;">
0.00394
</td>
<td style="text-align:right;">
0.15766
</td>
<td style="text-align:right;">
-0.44165
</td>
<td style="text-align:right;">
0.18095
</td>
<td style="text-align:right;">
1602.4157
</td>
<td style="text-align:right;">
0.99940
</td>
</tr>
<tr>
<td style="text-align:left;">
beta1_4
</td>
<td style="text-align:right;">
-1.54320
</td>
<td style="text-align:right;">
0.00478
</td>
<td style="text-align:right;">
0.18012
</td>
<td style="text-align:right;">
-1.89891
</td>
<td style="text-align:right;">
-1.18394
</td>
<td style="text-align:right;">
1416.9948
</td>
<td style="text-align:right;">
1.00073
</td>
</tr>
<tr>
<td style="text-align:left;">
beta1_5
</td>
<td style="text-align:right;">
-1.86424
</td>
<td style="text-align:right;">
0.00350
</td>
<td style="text-align:right;">
0.13799
</td>
<td style="text-align:right;">
-2.15179
</td>
<td style="text-align:right;">
-1.60893
</td>
<td style="text-align:right;">
1550.3122
</td>
<td style="text-align:right;">
1.00022
</td>
</tr>
<tr>
<td style="text-align:left;">
Cov_m_age
</td>
<td style="text-align:right;">
-0.40259
</td>
<td style="text-align:right;">
0.00017
</td>
<td style="text-align:right;">
0.00611
</td>
<td style="text-align:right;">
-0.41435
</td>
<td style="text-align:right;">
-0.39068
</td>
<td style="text-align:right;">
1276.1100
</td>
<td style="text-align:right;">
1.00098
</td>
</tr>
<tr>
<td style="text-align:left;">
Cov_sex
</td>
<td style="text-align:right;">
0.56756
</td>
<td style="text-align:right;">
0.00185
</td>
<td style="text-align:right;">
0.07475
</td>
<td style="text-align:right;">
0.42193
</td>
<td style="text-align:right;">
0.71624
</td>
<td style="text-align:right;">
1638.2822
</td>
<td style="text-align:right;">
0.99940
</td>
</tr>
<tr>
<td style="text-align:left;">
Cov_education
</td>
<td style="text-align:right;">
0.21144
</td>
<td style="text-align:right;">
0.00054
</td>
<td style="text-align:right;">
0.01807
</td>
<td style="text-align:right;">
0.17501
</td>
<td style="text-align:right;">
0.24628
</td>
<td style="text-align:right;">
1135.1825
</td>
<td style="text-align:right;">
0.99941
</td>
</tr>
</tbody>
</table>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
